const STRINGS = {
  en: {
    appTitle: 'Task Manager',
    loginTitle: 'Sign In',
    username: 'Username',
    password: 'Password',
    loginButton: 'Login',
    logout: 'Logout',
    adminDashboard: 'Admin Dashboard',
    userTasks: 'My Tasks',
    createTask: 'Create Task',
    taskTitle: 'Task Title',
    taskDescription: 'Description',
    deadline: 'Deadline',
    assignedTo: 'Assign to',
    status: 'Status',
    status_pending: 'Pending',
    status_in_progress: 'In Progress',
    status_done: 'Completed',
    uploadFiles: 'Upload files',
    save: 'Save',
    filterByUser: 'Filter by user',
    filterByStatus: 'Filter by status',
    filterByDate: 'Filter by date',
    noTasks: 'No tasks found',
    languageEnglish: 'English',
    languageArabic: 'Arabic',
    languageTurkish: 'Turkish',
    invalidCredentials: 'Invalid username or password',
    back: 'Back',
    edit: 'Edit',
    createdBy: 'Created by',
    adminLabel: 'Admin',
    view: 'View',
    filesHelpText: 'Files can be uploaded by both admin and staff when creating/updating tasks.',
    recentUpdates: 'Recent Updates',
    noUpdates: 'No updates yet.',
    statusLabel: 'Status',
    usersPageTitle: 'Users',
    addUser: 'Add User',
    existingUsers: 'Existing Users',
    role: 'Role',
    role_user: 'User',
    role_admin: 'Admin',
    notificationsTitle: 'Notifications',
    noNotifications: 'No new notifications.',
    viewTask: 'View Task',
    email: 'Email',
    emailHelpText: 'Email address for notifications (optional)',
    editTask: 'Edit Task',
    notePlaceholder: 'Work done / description (optional)',
    makeReport: 'Make a report',
    notification_task_assigned: 'New task assigned by {by}: {title}',
    notification_task_updated: 'Staff ({by}) updated task status (ID: {id}) - Status: {status} - Note: {note} - Attachment: {fileCount} file(s) uploaded',
    notification_task_updated_no_note: 'Staff ({by}) updated task status (ID: {id}) - Status: {status} - Attachment: {fileCount} file(s) uploaded',
    notification_task_updated_no_file: 'Staff ({by}) updated task status (ID: {id}) - Status: {status} - Note: {note}',
    notification_task_updated_simple: 'Staff ({by}) updated task status (ID: {id}) - Status: {status}',
    status_completed: 'Completed',
    status_in_progress_text: 'In Progress',
    status_pending_text: 'Pending',
    unread: 'Unread',
    read: 'Read',
    home: 'Home',
    menu: 'Menu',
    tarih: 'Date',
    konuSorumlusu: 'Subject Responsible',
    sorumlu: 'Responsible',
    sorumlu2: 'Responsible 2',
    sorumlu3: 'Responsible 3',
    bolge: 'Region',
    il: 'City',
    belediye: 'Municipality',
    departman: 'Department',
    arsiv: 'Archive',
    arsivVar: 'Yes',
    arsivYok: 'No',
    verilenIsTarihi: 'Given Job Date',
    tahminiIsBitistarihi: 'Estimated Job End Date',
    statusOnemli: 'Important',
    statusDevamEdiyor: 'In Progress',
    statusBitti: 'Completed',
    departmanSaha: 'Field',
    departmanBelediye: 'Municipality',
    departmanHukuk: 'Legal'
  },
  tr: {
    appTitle: 'Görev Yönetimi',
    loginTitle: 'Giriş Yap',
    username: 'Kullanıcı Adı',
    password: 'Şifre',
    loginButton: 'Giriş',
    logout: 'Çıkış',
    adminDashboard: 'Yönetici Paneli',
    userTasks: 'Görevlerim',
    createTask: 'Görev Oluştur',
    taskTitle: 'Görev Başlığı',
    taskDescription: 'Açıklama',
    deadline: 'Teslim Tarihi',
    assignedTo: 'Atanan',
    status: 'Durum',
    status_pending: 'Beklemede',
    status_in_progress: 'Devam Ediyor',
    status_done: 'Tamamlandı',
    uploadFiles: 'Dosya Yükle',
    save: 'Kaydet',
    filterByUser: 'Kullanıcıya göre filtrele',
    filterByStatus: 'Duruma göre filtrele',
    filterByDate: 'Tarihe göre filtrele',
    noTasks: 'Görev bulunamadı',
    languageEnglish: 'İngilizce',
    languageArabic: 'Arapça',
    languageTurkish: 'Türkçe',
    invalidCredentials: 'Geçersiz kullanıcı adı veya şifre',
    back: 'Geri',
    edit: 'Düzenle',
    createdBy: 'Oluşturan',
    adminLabel: 'Yönetici',
    view: 'Görüntüle',
    filesHelpText: 'Dosyalar görev oluştururken veya güncellerken hem yönetici hem de personel tarafından yüklenebilir.',
    recentUpdates: 'Son Güncellemeler',
    noUpdates: 'Henüz güncelleme yok.',
    statusLabel: 'Durum',
    usersPageTitle: 'Kullanıcılar',
    addUser: 'Kullanıcı Ekle',
    existingUsers: 'Mevcut Kullanıcılar',
    role: 'Rol',
    role_user: 'Kullanıcı',
    role_admin: 'Yönetici',
    notificationsTitle: 'Bildirimler',
    noNotifications: 'Yeni bildirim yok.',
    viewTask: 'Görevi Görüntüle',
    email: 'E-posta',
    emailHelpText: 'Bildirimler için e-posta adresi (isteğe bağlı)',
    editTask: 'Görevi Düzenle',
    notePlaceholder: 'Yapılan iş / açıklama (isteğe bağlı)',
    makeReport: 'Rapor oluştur',
    notification_task_assigned: '{by} tarafından yeni görev atandı: {title}',
    notification_task_updated: 'Personel ({by}) görev durumunu güncelledi (ID: {id}) - Durum: {status} - Not: {note} - Ek: {fileCount} dosya yüklendi',
    notification_task_updated_no_note: 'Personel ({by}) görev durumunu güncelledi (ID: {id}) - Durum: {status} - Ek: {fileCount} dosya yüklendi',
    notification_task_updated_no_file: 'Personel ({by}) görev durumunu güncelledi (ID: {id}) - Durum: {status} - Not: {note}',
    notification_task_updated_simple: 'Personel ({by}) görev durumunu güncelledi (ID: {id}) - Durum: {status}',
    status_completed: 'Tamamlandı',
    status_in_progress_text: 'Devam Ediyor',
    status_pending_text: 'Beklemede',
    unread: 'Okunmamış',
    read: 'Okundu',
    home: 'Ana Sayfa',
    menu: 'Menü',
    tarih: 'Tarih',
    konuSorumlusu: 'Konu Sorumlusu',
    sorumlu: 'Sorumlu',
    sorumlu2: 'Sorumlu 2',
    sorumlu3: 'Sorumlu 3',
    bolge: 'Bölge',
    il: 'İl',
    belediye: 'Belediye',
    departman: 'Departman',
    arsiv: 'Arşiv',
    arsivVar: 'Var',
    arsivYok: 'Yok',
    verilenIsTarihi: 'Verilen İş Tarihi',
    tahminiIsBitistarihi: 'Tahmini İş Bitiş Tarihi',
    statusOnemli: 'Önemli',
    statusDevamEdiyor: 'Devam Ediyor',
    statusBitti: 'Bitti',
    departmanSaha: 'Saha',
    departmanBelediye: 'Belediye',
    departmanHukuk: 'Hukuk'
  },
  ar: {
    appTitle: 'نظام إدارة المهام',
    loginTitle: 'تسجيل الدخول',
    username: 'اسم المستخدم',
    password: 'كلمة المرور',
    loginButton: 'دخول',
    logout: 'تسجيل الخروج',
    adminDashboard: 'لوحة التحكم (المدير)',
    userTasks: 'مهامي',
    createTask: 'إنشاء مهمة',
    taskTitle: 'عنوان المهمة',
    taskDescription: 'وصف المهمة',
    deadline: 'تاريخ التسليم',
    assignedTo: 'تعيين إلى',
    status: 'الحالة',
    status_pending: 'قيد الانتظار',
    status_in_progress: 'قيد التنفيذ',
    status_done: 'مكتملة',
    uploadFiles: 'رفع الملفات',
    save: 'حفظ',
    filterByUser: 'تصفية حسب الموظف',
    filterByStatus: 'تصفية حسب الحالة',
    filterByDate: 'تصفية حسب التاريخ',
    noTasks: 'لا توجد مهام',
    languageEnglish: 'الإنجليزية',
    languageArabic: 'العربية',
    languageTurkish: 'التركية',
    invalidCredentials: 'اسم المستخدم أو كلمة المرور غير صحيحة',
    back: 'رجوع',
    edit: 'تعديل',
    createdBy: 'أنشئت بواسطة',
    adminLabel: 'المدير',
    view: 'عرض',
    filesHelpText: 'يمكن للمدير والموظفين رفع الملفات عند إنشاء أو تحديث المهمة.',
    recentUpdates: 'أحدث التحديثات',
    noUpdates: 'لا توجد تحديثات مسجلة بعد.',
    statusLabel: 'الحالة',
    usersPageTitle: 'المستخدمون',
    addUser: 'إضافة مستخدم',
    existingUsers: 'المستخدمون الحاليون',
    role: 'الدور',
    role_user: 'موظف',
    role_admin: 'مدير',
    notificationsTitle: 'الإشعارات',
    noNotifications: 'لا توجد إشعارات جديدة.',
    viewTask: 'عرض المهمة',
    email: 'البريد الإلكتروني',
    emailHelpText: 'عنوان البريد الإلكتروني للإشعارات (اختياري)',
    editTask: 'تعديل المهمة',
    notePlaceholder: 'الوصف / ما تم إنجازه (اختياري)',
    makeReport: 'إنشاء تقرير',
    notification_task_assigned: 'تم تعيين مهمة جديدة بواسطة {by}: {title}',
    notification_task_updated: 'قام الموظف ({by}) بتحديث حالة المهمة (ID: {id}) - الحالة: {status} - الملاحظة: {note} - المرفق: تم رفع {fileCount} ملف',
    notification_task_updated_no_note: 'قام الموظف ({by}) بتحديث حالة المهمة (ID: {id}) - الحالة: {status} - المرفق: تم رفع {fileCount} ملف',
    notification_task_updated_no_file: 'قام الموظف ({by}) بتحديث حالة المهمة (ID: {id}) - الحالة: {status} - الملاحظة: {note}',
    notification_task_updated_simple: 'قام الموظف ({by}) بتحديث حالة المهمة (ID: {id}) - الحالة: {status}',
    status_completed: 'مكتملة',
    status_in_progress_text: 'قيد التنفيذ',
    status_pending_text: 'قيد الانتظار',
    unread: 'غير مقروء',
    read: 'مقروء',
    home: 'الرئيسية',
    menu: 'القائمة',
    tarih: 'التاريخ',
    konuSorumlusu: 'مسؤول الموضوع',
    sorumlu: 'المسؤول',
    sorumlu2: 'المسؤول 2',
    sorumlu3: 'المسؤول 3',
    bolge: 'المنطقة',
    il: 'المدينة',
    belediye: 'البلدية',
    departman: 'القسم',
    arsiv: 'الأرشيف',
    arsivVar: 'نعم',
    arsivYok: 'لا',
    verilenIsTarihi: 'تاريخ إعطاء العمل',
    tahminiIsBitistarihi: 'تاريخ انتهاء العمل المتوقع',
    statusOnemli: 'مهم',
    statusDevamEdiyor: 'قيد التنفيذ',
    statusBitti: 'انتهى',
    departmanSaha: 'الميدان',
    departmanBelediye: 'البلدية',
    departmanHukuk: 'القانون'
  }
};

function getI18nMiddleware() {
  return (req, res, next) => {
    const sessionLang = req.session.lang;
    let lang = 'en';
    if (sessionLang === 'ar') {
      lang = 'ar';
    } else if (sessionLang === 'tr') {
      lang = 'tr';
    }
    req.lang = lang;
    req.dir = lang === 'ar' ? 'rtl' : 'ltr';
    req.t = (key) => STRINGS[lang][key] || key;
    res.locals.t = req.t;
    res.locals.lang = lang;
    res.locals.dir = req.dir;
    res.locals.currentUser = req.user;
    next();
  };
}

module.exports = {
  getI18nMiddleware
};


