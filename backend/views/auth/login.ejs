<%- include('../partials/flash'); %>

<div class="row justify-content-center">
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="text-center mb-3">
          <img
            src="/public/img/site_ikon.png"
            alt="AJ ƒ∞≈ü Takip"
            class="mb-2"
            style="max-width: 140px; height: auto;"
          />
          <div class="fw-bold" style="font-size: 1.3rem;">AJ ƒ∞≈ü Takip</div>
          <div class="text-muted small"><%= t('loginTitle') %></div>
        </div>
        <% if (error) { %>
        <div class="alert alert-danger py-2">
          <%= error %>
        </div>
        <% } %>
        <form method="post" action="<%= (typeof targetRole !== 'undefined' && targetRole === 'user') ? '/user-login' : '/login' %>" id="loginForm">
          <div class="mb-3">
            <label class="form-label"><%= t('username') %></label>
            <input type="text" name="username" class="form-control" required autocomplete="username" />
          </div>
          <div class="mb-3">
            <label class="form-label"><%= t('password') %></label>
            <input
              type="password"
              name="password"
              class="form-control"
              autocomplete="current-password"
              required
            />
          </div>
          <button type="submit" class="btn btn-primary w-100" id="loginBtn">
            <%= t('loginButton') %>
          </button>
        </form>
        <script>
          // Debug: Form submit kontrol√º
          (function() {
            const form = document.getElementById('loginForm');
            if (!form) {
              console.error('‚ùå Login form not found!');
              return;
            }
            
            console.log('‚úÖ Login form found');
            console.log('  Form action:', form.action);
            console.log('  Form method:', form.method);
            
            // Form submit event
            form.addEventListener('submit', function(e) {
              console.log('üîê Form submitting...');
              const formData = new FormData(this);
              const username = formData.get('username');
              const password = formData.get('password');
              
              console.log('  Username:', username || 'MISSING');
              console.log('  Password:', password ? '***' : 'MISSING');
              console.log('  Action:', this.action);
              
              if (!username || !password) {
                console.error('‚ùå Username or password is missing!');
                e.preventDefault();
                alert('L√ºtfen kullanƒ±cƒ± adƒ± ve ≈üifre girin!');
                return false;
              }
              
              console.log('‚úÖ Form data valid, submitting...');
            });
            
            // Button click event (backup)
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
              loginBtn.addEventListener('click', function(e) {
                console.log('üîò Login button clicked');
              });
            }
          })();
        </script>
        <% /* demo admin hint removed */ %>
      </div>
    </div>
  </div>
</div>


